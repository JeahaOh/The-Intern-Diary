-- 후기
ALTER TABLE review
	DROP FOREIGN KEY FK_memb_TO_review; -- 회원 -> 후기

-- 메뉴판
ALTER TABLE menu_board
	DROP FOREIGN KEY FK_rstrnt_TO_menu_board; -- 레스토랑 -> 메뉴판

-- 메뉴판
ALTER TABLE menu_board
	DROP FOREIGN KEY FK_menu_TO_menu_board; -- 메뉴 -> 메뉴판

-- 관리 요청
ALTER TABLE rpt
	DROP FOREIGN KEY FK_memb_TO_rpt; -- 회원 -> 관리 요청

-- 관리 요청
ALTER TABLE rpt
	DROP FOREIGN KEY FK_rstrnt_TO_rpt; -- 레스토랑 -> 관리 요청

-- 관리 요청
ALTER TABLE rpt
	DROP FOREIGN KEY FK_review_TO_rpt; -- 후기 -> 관리 요청

-- 사진
ALTER TABLE phot
	DROP FOREIGN KEY FK_review_TO_phot; -- 후기 -> 사진

-- 레스토랑 - 사진
ALTER TABLE rst_pht
	DROP FOREIGN KEY FK_rstrnt_TO_rst_pht; -- 레스토랑 -> 레스토랑 - 사진

-- 레스토랑 - 사진
ALTER TABLE rst_pht
	DROP FOREIGN KEY FK_phot_TO_rst_pht; -- 사진 -> 레스토랑 - 사진

-- 평점
ALTER TABLE score
	DROP FOREIGN KEY FK_review_TO_score; -- 후기 -> 평점

-- 평점
ALTER TABLE score
	DROP FOREIGN KEY FK_rstrnt_TO_score; -- 레스토랑 -> 평점

-- 레스토랑
ALTER TABLE rstrnt
	DROP PRIMARY KEY; -- 레스토랑 기본키

-- 회원
ALTER TABLE memb
	DROP PRIMARY KEY; -- 회원 기본키

-- 후기
ALTER TABLE review
	DROP PRIMARY KEY; -- 후기 기본키

-- 메뉴
ALTER TABLE menu
	DROP PRIMARY KEY; -- 메뉴 기본키

-- 메뉴판
ALTER TABLE menu_board
	DROP PRIMARY KEY; -- 메뉴판 기본키

-- 관리 요청
ALTER TABLE rpt
	DROP PRIMARY KEY; -- 관리 요청 기본키

-- 사진
ALTER TABLE phot
	DROP PRIMARY KEY; -- 사진 기본키

-- 레스토랑 - 사진
ALTER TABLE rst_pht
	DROP PRIMARY KEY; -- 레스토랑 - 사진 기본키

-- 평점
ALTER TABLE score
	DROP PRIMARY KEY; -- 평점 기본키

-- 레스토랑
DROP TABLE IF EXISTS rstrnt RESTRICT;

-- 회원
DROP TABLE IF EXISTS memb RESTRICT;

-- 후기
DROP TABLE IF EXISTS review RESTRICT;

-- 메뉴
DROP TABLE IF EXISTS menu RESTRICT;

-- 메뉴판
DROP TABLE IF EXISTS menu_board RESTRICT;

-- 관리 요청
DROP TABLE IF EXISTS rpt RESTRICT;

-- 사진
DROP TABLE IF EXISTS phot RESTRICT;

-- 레스토랑 - 사진
DROP TABLE IF EXISTS rst_pht RESTRICT;

-- 평점
DROP TABLE IF EXISTS score RESTRICT;

-- 레스토랑
CREATE TABLE rstrnt (
	rstrnt_no   INT          NOT NULL COMMENT '레스토랑 번호', -- 레스토랑 번호
	rstrnt_name VARCHAR(50)  NOT NULL COMMENT '가게 이름', -- 가게 이름
	star        INTEGER      NOT NULL COMMENT '별점', -- 별점
	loc         VARCHAR(50)  NULL     COMMENT '지역', -- 지역
	loc_dtl     VARCHAR(255) NOT NULL COMMENT '상세 주소', -- 상세 주소
	catg        VARCHAR(50)  NOT NULL COMMENT '요리유형', -- 요리유형
	tel         VARCHAR(30)  NULL     COMMENT '전화번호' -- 전화번호
)
COMMENT '레스토랑';

-- 레스토랑
ALTER TABLE rstrnt
	ADD CONSTRAINT PK_rstrnt -- 레스토랑 기본키
		PRIMARY KEY (
			rstrnt_no -- 레스토랑 번호
		);

ALTER TABLE rstrnt
	MODIFY COLUMN rstrnt_no INT NOT NULL AUTO_INCREMENT COMMENT '레스토랑 번호';

ALTER TABLE rstrnt
	AUTO_INCREMENT = 1;

-- 회원
CREATE TABLE memb (
	mno   INT         NOT NULL COMMENT '멤버 번호', -- 멤버 번호
	id    VARCHAR(50) NOT NULL COMMENT '아이디', -- 아이디
	adm   CHAR(1)     NULL     COMMENT '관리자', -- 관리자
	nick  VARCHAR(50) NULL     COMMENT '닉네임', -- 닉네임
	pwd   VARCHAR(50) NOT NULL COMMENT '비밀번호', -- 비밀번호
	useyn CHAR(1)     NULL     COMMENT '사용여부' -- 사용여부
)
COMMENT '회원';

-- 회원
ALTER TABLE memb
	ADD CONSTRAINT PK_memb -- 회원 기본키
		PRIMARY KEY (
			mno -- 멤버 번호
		);

-- 회원 유니크 인덱스
CREATE UNIQUE INDEX UIX_memb
	ON memb ( -- 회원
		id ASC -- 아이디
	);

ALTER TABLE memb
	MODIFY COLUMN mno INT NOT NULL AUTO_INCREMENT COMMENT '멤버 번호';

ALTER TABLE memb
	AUTO_INCREMENT = 1;

-- 후기
CREATE TABLE review (
	review_no INT      NOT NULL COMMENT '리뷰 번호', -- 리뷰 번호
	mno       INT      NULL     COMMENT '멤버 번호', -- 멤버 번호
	cont      TEXT     NULL     COMMENT '내용', -- 내용
	cdt       DATETIME NULL     COMMENT '생성 일자' -- 생성 일자
)
COMMENT '후기';

-- 후기
ALTER TABLE review
	ADD CONSTRAINT PK_review -- 후기 기본키
		PRIMARY KEY (
			review_no -- 리뷰 번호
		);

ALTER TABLE review
	MODIFY COLUMN review_no INT NOT NULL AUTO_INCREMENT COMMENT '리뷰 번호';

ALTER TABLE review
	AUTO_INCREMENT = 1;

-- 메뉴
CREATE TABLE menu (
	mn_no INT         NOT NULL COMMENT '메뉴 번호', -- 메뉴 번호
	menu  VARCHAR(50) NOT NULL COMMENT '메뉴 이름', -- 메뉴 이름
	price INTEGER     NOT NULL COMMENT '메뉴 가격' -- 메뉴 가격
)
COMMENT '메뉴';

-- 메뉴
ALTER TABLE menu
	ADD CONSTRAINT PK_menu -- 메뉴 기본키
		PRIMARY KEY (
			mn_no -- 메뉴 번호
		);

ALTER TABLE menu
	MODIFY COLUMN mn_no INT NOT NULL AUTO_INCREMENT COMMENT '메뉴 번호';

ALTER TABLE menu
	AUTO_INCREMENT = 1;

-- 메뉴판
CREATE TABLE menu_board (
	brd_no    INT NOT NULL COMMENT '메뉴판 번호', -- 메뉴판 번호
	rstrnt_no INT NOT NULL COMMENT '레스토랑 번호', -- 레스토랑 번호
	mn_no     INT NOT NULL COMMENT '메뉴 번호' -- 메뉴 번호
)
COMMENT '메뉴판';

-- 메뉴판
ALTER TABLE menu_board
	ADD CONSTRAINT PK_menu_board -- 메뉴판 기본키
		PRIMARY KEY (
			brd_no,    -- 메뉴판 번호
			rstrnt_no, -- 레스토랑 번호
			mn_no      -- 메뉴 번호
		);

ALTER TABLE menu_board
	MODIFY COLUMN brd_no INT NOT NULL AUTO_INCREMENT COMMENT '메뉴판 번호';

ALTER TABLE menu_board
	AUTO_INCREMENT = 1;

-- 관리 요청
CREATE TABLE rpt (
	rpt_no    INT      NOT NULL COMMENT '요청 번호', -- 요청 번호
	mno       INT      NOT NULL COMMENT '멤버 번호', -- 멤버 번호
	rstrnt_no INT      NULL     COMMENT '레스토랑 번호', -- 레스토랑 번호
	review_no INT      NULL     COMMENT '리뷰 번호', -- 리뷰 번호
	rpt_cont  TEXT     NOT NULL COMMENT '요청 내용', -- 요청 내용
	rpt_date  DATETIME NOT NULL COMMENT '요청 일자', -- 요청 일자
	hndl      CHAR(1)  NOT NULL COMMENT '처리 여부', -- 처리 여부
	hndl_cont TEXT     NOT NULL COMMENT '처리 내용' -- 처리 내용
)
COMMENT '관리 요청';

-- 관리 요청
ALTER TABLE rpt
	ADD CONSTRAINT PK_rpt -- 관리 요청 기본키
		PRIMARY KEY (
			rpt_no -- 요청 번호
		);

ALTER TABLE rpt
	MODIFY COLUMN rpt_no INT NOT NULL AUTO_INCREMENT COMMENT '요청 번호';

ALTER TABLE rpt
	AUTO_INCREMENT = 1;

-- 사진
CREATE TABLE phot (
	phot_no   INT          NOT NULL COMMENT '사진 번호', -- 사진 번호
	review_no INT          NULL     COMMENT '리뷰 번호', -- 리뷰 번호
	phot_nm   VARCHAR(255) NOT NULL COMMENT '사진 이름' -- 사진 이름
)
COMMENT '사진';

-- 사진
ALTER TABLE phot
	ADD CONSTRAINT PK_phot -- 사진 기본키
		PRIMARY KEY (
			phot_no -- 사진 번호
		);

-- 사진 유니크 인덱스
CREATE UNIQUE INDEX UIX_phot
	ON phot ( -- 사진
		phot_nm ASC -- 사진 이름
	);

ALTER TABLE phot
	MODIFY COLUMN phot_no INT NOT NULL AUTO_INCREMENT COMMENT '사진 번호';

ALTER TABLE phot
	AUTO_INCREMENT = 1;

-- 레스토랑 - 사진
CREATE TABLE rst_pht (
	rp_no     INT NOT NULL COMMENT '레스토랑 사진 번호', -- 레스토랑 사진 번호
	rstrnt_no INT NOT NULL COMMENT '레스토랑 번호', -- 레스토랑 번호
	phot_no   INT NOT NULL COMMENT '사진 번호' -- 사진 번호
)
COMMENT '레스토랑 - 사진';

-- 레스토랑 - 사진
ALTER TABLE rst_pht
	ADD CONSTRAINT PK_rst_pht -- 레스토랑 - 사진 기본키
		PRIMARY KEY (
			rp_no,     -- 레스토랑 사진 번호
			rstrnt_no, -- 레스토랑 번호
			phot_no    -- 사진 번호
		);

ALTER TABLE rst_pht
	MODIFY COLUMN rp_no INT NOT NULL AUTO_INCREMENT COMMENT '레스토랑 사진 번호';

ALTER TABLE rst_pht
	AUTO_INCREMENT = 1;

-- 평점
CREATE TABLE score (
	scr_no    INT     NOT NULL COMMENT '평점 번호', -- 평점 번호
	review_no INT     NOT NULL COMMENT '리뷰 번호', -- 리뷰 번호
	rstrnt_no INT     NOT NULL COMMENT '레스토랑 번호', -- 레스토랑 번호
	score     INTEGER NOT NULL COMMENT '평점' -- 평점
)
COMMENT '평점';

-- 평점
ALTER TABLE score
	ADD CONSTRAINT PK_score -- 평점 기본키
		PRIMARY KEY (
			scr_no,    -- 평점 번호
			review_no, -- 리뷰 번호
			rstrnt_no  -- 레스토랑 번호
		);

ALTER TABLE score
	MODIFY COLUMN scr_no INT NOT NULL AUTO_INCREMENT COMMENT '평점 번호';

ALTER TABLE score
	AUTO_INCREMENT = 1;

-- 후기
ALTER TABLE review
	ADD CONSTRAINT FK_memb_TO_review -- 회원 -> 후기
		FOREIGN KEY (
			mno -- 멤버 번호
		)
		REFERENCES memb ( -- 회원
			mno -- 멤버 번호
		);

-- 메뉴판
ALTER TABLE menu_board
	ADD CONSTRAINT FK_rstrnt_TO_menu_board -- 레스토랑 -> 메뉴판
		FOREIGN KEY (
			rstrnt_no -- 레스토랑 번호
		)
		REFERENCES rstrnt ( -- 레스토랑
			rstrnt_no -- 레스토랑 번호
		);

-- 메뉴판
ALTER TABLE menu_board
	ADD CONSTRAINT FK_menu_TO_menu_board -- 메뉴 -> 메뉴판
		FOREIGN KEY (
			mn_no -- 메뉴 번호
		)
		REFERENCES menu ( -- 메뉴
			mn_no -- 메뉴 번호
		);

-- 관리 요청
ALTER TABLE rpt
	ADD CONSTRAINT FK_memb_TO_rpt -- 회원 -> 관리 요청
		FOREIGN KEY (
			mno -- 멤버 번호
		)
		REFERENCES memb ( -- 회원
			mno -- 멤버 번호
		);

-- 관리 요청
ALTER TABLE rpt
	ADD CONSTRAINT FK_rstrnt_TO_rpt -- 레스토랑 -> 관리 요청
		FOREIGN KEY (
			rstrnt_no -- 레스토랑 번호
		)
		REFERENCES rstrnt ( -- 레스토랑
			rstrnt_no -- 레스토랑 번호
		);

-- 관리 요청
ALTER TABLE rpt
	ADD CONSTRAINT FK_review_TO_rpt -- 후기 -> 관리 요청
		FOREIGN KEY (
			review_no -- 리뷰 번호
		)
		REFERENCES review ( -- 후기
			review_no -- 리뷰 번호
		);

-- 사진
ALTER TABLE phot
	ADD CONSTRAINT FK_review_TO_phot -- 후기 -> 사진
		FOREIGN KEY (
			review_no -- 리뷰 번호
		)
		REFERENCES review ( -- 후기
			review_no -- 리뷰 번호
		);

-- 레스토랑 - 사진
ALTER TABLE rst_pht
	ADD CONSTRAINT FK_rstrnt_TO_rst_pht -- 레스토랑 -> 레스토랑 - 사진
		FOREIGN KEY (
			rstrnt_no -- 레스토랑 번호
		)
		REFERENCES rstrnt ( -- 레스토랑
			rstrnt_no -- 레스토랑 번호
		);

-- 레스토랑 - 사진
ALTER TABLE rst_pht
	ADD CONSTRAINT FK_phot_TO_rst_pht -- 사진 -> 레스토랑 - 사진
		FOREIGN KEY (
			phot_no -- 사진 번호
		)
		REFERENCES phot ( -- 사진
			phot_no -- 사진 번호
		);

-- 평점
ALTER TABLE score
	ADD CONSTRAINT FK_review_TO_score -- 후기 -> 평점
		FOREIGN KEY (
			review_no -- 리뷰 번호
		)
		REFERENCES review ( -- 후기
			review_no -- 리뷰 번호
		);

-- 평점
ALTER TABLE score
	ADD CONSTRAINT FK_rstrnt_TO_score -- 레스토랑 -> 평점
		FOREIGN KEY (
			rstrnt_no -- 레스토랑 번호
		)
		REFERENCES rstrnt ( -- 레스토랑
			rstrnt_no -- 레스토랑 번호
		);