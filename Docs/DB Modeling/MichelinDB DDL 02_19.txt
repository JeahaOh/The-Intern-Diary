-- 후기
ALTER TABLE review
	DROP FOREIGN KEY FK_rstrnt_TO_review; -- 레스토랑 -> 후기

-- 후기
ALTER TABLE review
	DROP FOREIGN KEY FK_memb_TO_review; -- 회원 -> 후기

-- 메뉴판
ALTER TABLE menu_board
	DROP FOREIGN KEY FK_rstrnt_TO_menu_board; -- 레스토랑 -> 메뉴판

-- 메뉴판
ALTER TABLE menu_board
	DROP FOREIGN KEY FK_menu_TO_menu_board; -- 메뉴 -> 메뉴판

-- 신고
ALTER TABLE rpt
	DROP FOREIGN KEY FK_memb_TO_rpt; -- 회원 -> 신고

-- 레스토랑_사진
ALTER TABLE rstrnt_phot
	DROP FOREIGN KEY FK_rstrnt_TO_rstrnt_phot; -- 레스토랑 -> 레스토랑_사진

-- 후기_사진
ALTER TABLE rievew_phot
	DROP FOREIGN KEY FK_review_TO_rievew_phot; -- 후기 -> 후기_사진

-- 레스토랑
ALTER TABLE rstrnt
	DROP PRIMARY KEY; -- 레스토랑 기본키

-- 회원
ALTER TABLE memb
	DROP PRIMARY KEY; -- 회원 기본키

-- 후기
ALTER TABLE review
	DROP PRIMARY KEY; -- 후기 기본키

-- 메뉴
ALTER TABLE menu
	DROP PRIMARY KEY; -- 메뉴 기본키

-- 메뉴판
ALTER TABLE menu_board
	DROP PRIMARY KEY; -- 메뉴판 기본키

-- 신고
ALTER TABLE rpt
	DROP PRIMARY KEY; -- 신고 기본키

-- 레스토랑_사진
ALTER TABLE rstrnt_phot
	DROP PRIMARY KEY; -- 레스토랑_사진 기본키

-- 후기_사진
ALTER TABLE rievew_phot
	DROP PRIMARY KEY; -- 후기_사진 기본키

-- 레스토랑
DROP TABLE IF EXISTS rstrnt RESTRICT;

-- 회원
DROP TABLE IF EXISTS memb RESTRICT;

-- 후기
DROP TABLE IF EXISTS review RESTRICT;

-- 메뉴
DROP TABLE IF EXISTS menu RESTRICT;

-- 메뉴판
DROP TABLE IF EXISTS menu_board RESTRICT;

-- 신고
DROP TABLE IF EXISTS rpt RESTRICT;

-- 레스토랑_사진
DROP TABLE IF EXISTS rstrnt_phot RESTRICT;

-- 후기_사진
DROP TABLE IF EXISTS rievew_phot RESTRICT;

-- 레스토랑
CREATE TABLE rstrnt (
	rstrnt_no   INT          NOT NULL COMMENT '레스토랑 번호', -- 레스토랑 번호
	rstrnt_name VARCHAR(50)  NOT NULL COMMENT '가게 이름', -- 가게 이름
	star        INTEGER      NOT NULL COMMENT '별점', -- 별점
	loc         VARCHAR(50)  NULL     COMMENT '지역', -- 지역
	loc_dtl     VARCHAR(255) NOT NULL COMMENT '상세 주소', -- 상세 주소
	type        VARCHAR(50)  NOT NULL COMMENT '요리유형', -- 요리유형
	call        VARCHAR(30)  NULL     COMMENT '전화번호' -- 전화번호
)
COMMENT '레스토랑';

-- 레스토랑
ALTER TABLE rstrnt
	ADD CONSTRAINT PK_rstrnt -- 레스토랑 기본키
		PRIMARY KEY (
			rstrnt_no -- 레스토랑 번호
		);

ALTER TABLE rstrnt
	MODIFY COLUMN rstrnt_no INT NOT NULL AUTO_INCREMENT COMMENT '레스토랑 번호';

ALTER TABLE rstrnt
	AUTO_INCREMENT = 1;

-- 회원
CREATE TABLE memb (
	mno   INT         NOT NULL COMMENT '멤버 번호', -- 멤버 번호
	id    VARCHAR(50) NOT NULL COMMENT '아이디', -- 아이디
	admin CHAR(1)     NULL     COMMENT '관리자', -- 관리자
	nick  VARCHAR(50) NULL     COMMENT '닉네임', -- 닉네임
	pwd   VARCHAR(50) NOT NULL COMMENT '비밀번호', -- 비밀번호
	useyn CHAR(1)     NULL     COMMENT '사용여부' -- 사용여부
)
COMMENT '회원';

-- 회원
ALTER TABLE memb
	ADD CONSTRAINT PK_memb -- 회원 기본키
		PRIMARY KEY (
			mno -- 멤버 번호
		);

-- 회원 유니크 인덱스
CREATE UNIQUE INDEX UIX_memb
	ON memb ( -- 회원
		id ASC -- 아이디
	);

ALTER TABLE memb
	MODIFY COLUMN mno INT NOT NULL AUTO_INCREMENT COMMENT '멤버 번호';

ALTER TABLE memb
	AUTO_INCREMENT = 1;

-- 후기
CREATE TABLE review (
	review_no INT      NOT NULL COMMENT '리뷰 번호', -- 리뷰 번호
	rstrnt_no INT      NULL     COMMENT '레스토랑 번호', -- 레스토랑 번호
	mno       INT      NULL     COMMENT '멤버 번호', -- 멤버 번호
	cont      TEXT     NULL     COMMENT '내용', -- 내용
	score     INTEGER  NULL     COMMENT '평점', -- 평점
	cdt       DATETIME NULL     COMMENT '생성 일자' -- 생성 일자
)
COMMENT '후기';

-- 후기
ALTER TABLE review
	ADD CONSTRAINT PK_review -- 후기 기본키
		PRIMARY KEY (
			review_no -- 리뷰 번호
		);

ALTER TABLE review
	MODIFY COLUMN review_no INT NOT NULL AUTO_INCREMENT COMMENT '리뷰 번호';

ALTER TABLE review
	AUTO_INCREMENT = 1;

-- 메뉴
CREATE TABLE menu (
	mn_no INT         NOT NULL COMMENT '메뉴 번호', -- 메뉴 번호
	menu  VARCHAR(50) NOT NULL COMMENT '메뉴 이름', -- 메뉴 이름
	price INTEGER     NOT NULL COMMENT '메뉴 가격' -- 메뉴 가격
)
COMMENT '메뉴';

-- 메뉴
ALTER TABLE menu
	ADD CONSTRAINT PK_menu -- 메뉴 기본키
		PRIMARY KEY (
			mn_no -- 메뉴 번호
		);

ALTER TABLE menu
	MODIFY COLUMN mn_no INT NOT NULL AUTO_INCREMENT COMMENT '메뉴 번호';

ALTER TABLE menu
	AUTO_INCREMENT = 1;

-- 메뉴판
CREATE TABLE menu_board (
	rstrnt_no INT NOT NULL COMMENT '레스토랑 번호', -- 레스토랑 번호
	mn_no     INT NOT NULL COMMENT '메뉴 번호' -- 메뉴 번호
)
COMMENT '메뉴판';

-- 메뉴판
ALTER TABLE menu_board
	ADD CONSTRAINT PK_menu_board -- 메뉴판 기본키
		PRIMARY KEY (
			rstrnt_no, -- 레스토랑 번호
			mn_no      -- 메뉴 번호
		);

-- 신고
CREATE TABLE rpt (
	rpt_no    INT         NOT NULL COMMENT '신고 번호', -- 신고 번호
	mno       INT         NOT NULL COMMENT '멤버 번호', -- 멤버 번호
	trgt      VARCHAR(50) NOT NULL COMMENT '신고 대상', -- 신고 대상
	trgt_no   INT         NOT NULL COMMENT '대상 번호', -- 대상 번호
	rpt_cont  TEXT        NOT NULL COMMENT '신고 내용', -- 신고 내용
	rpt_date  DATETIME    NULL     COMMENT '신고 일자 ', -- 신고 일자 
	hndl      CHAR(1)     NULL     COMMENT '처리 여부', -- 처리 여부
	hndl_cont TEXT        NULL     COMMENT '처리 내용' -- 처리 내용
)
COMMENT '신고';

-- 신고
ALTER TABLE rpt
	ADD CONSTRAINT PK_rpt -- 신고 기본키
		PRIMARY KEY (
			rpt_no -- 신고 번호
		);

ALTER TABLE rpt
	MODIFY COLUMN rpt_no INT NOT NULL AUTO_INCREMENT COMMENT '신고 번호';

ALTER TABLE rpt
	AUTO_INCREMENT = 1;

-- 레스토랑_사진
CREATE TABLE rstrnt_phot (
	phot_no   INT          NOT NULL COMMENT '사진 번호', -- 사진 번호
	rstrnt_no INT          NULL     COMMENT '레스토랑 번호', -- 레스토랑 번호
	phot_nm   VARCHAR(255) NULL     COMMENT '사진 이름' -- 사진 이름
)
COMMENT '레스토랑_사진';

-- 레스토랑_사진
ALTER TABLE rstrnt_phot
	ADD CONSTRAINT PK_rstrnt_phot -- 레스토랑_사진 기본키
		PRIMARY KEY (
			phot_no -- 사진 번호
		);

-- 레스토랑_사진 유니크 인덱스
CREATE UNIQUE INDEX UIX_rstrnt_phot
	ON rstrnt_phot ( -- 레스토랑_사진
		phot_nm ASC -- 사진 이름
	);

-- 후기_사진
CREATE TABLE rievew_phot (
	phot_no   INT          NOT NULL COMMENT '사진 번호', -- 사진 번호
	review_no INT          NULL     COMMENT '리뷰 번호', -- 리뷰 번호
	phot_nm   VARCHAR(255) NULL     COMMENT '사진 이름' -- 사진 이름
)
COMMENT '후기_사진';

-- 후기_사진
ALTER TABLE rievew_phot
	ADD CONSTRAINT PK_rievew_phot -- 후기_사진 기본키
		PRIMARY KEY (
			phot_no -- 사진 번호
		);

-- 후기_사진 유니크 인덱스
CREATE UNIQUE INDEX UIX_rievew_phot
	ON rievew_phot ( -- 후기_사진
		phot_nm ASC -- 사진 이름
	);

-- 후기
ALTER TABLE review
	ADD CONSTRAINT FK_rstrnt_TO_review -- 레스토랑 -> 후기
		FOREIGN KEY (
			rstrnt_no -- 레스토랑 번호
		)
		REFERENCES rstrnt ( -- 레스토랑
			rstrnt_no -- 레스토랑 번호
		);

-- 후기
ALTER TABLE review
	ADD CONSTRAINT FK_memb_TO_review -- 회원 -> 후기
		FOREIGN KEY (
			mno -- 멤버 번호
		)
		REFERENCES memb ( -- 회원
			mno -- 멤버 번호
		);

-- 메뉴판
ALTER TABLE menu_board
	ADD CONSTRAINT FK_rstrnt_TO_menu_board -- 레스토랑 -> 메뉴판
		FOREIGN KEY (
			rstrnt_no -- 레스토랑 번호
		)
		REFERENCES rstrnt ( -- 레스토랑
			rstrnt_no -- 레스토랑 번호
		);

-- 메뉴판
ALTER TABLE menu_board
	ADD CONSTRAINT FK_menu_TO_menu_board -- 메뉴 -> 메뉴판
		FOREIGN KEY (
			mn_no -- 메뉴 번호
		)
		REFERENCES menu ( -- 메뉴
			mn_no -- 메뉴 번호
		);

-- 신고
ALTER TABLE rpt
	ADD CONSTRAINT FK_memb_TO_rpt -- 회원 -> 신고
		FOREIGN KEY (
			mno -- 멤버 번호
		)
		REFERENCES memb ( -- 회원
			mno -- 멤버 번호
		);

-- 레스토랑_사진
ALTER TABLE rstrnt_phot
	ADD CONSTRAINT FK_rstrnt_TO_rstrnt_phot -- 레스토랑 -> 레스토랑_사진
		FOREIGN KEY (
			rstrnt_no -- 레스토랑 번호
		)
		REFERENCES rstrnt ( -- 레스토랑
			rstrnt_no -- 레스토랑 번호
		);

-- 후기_사진
ALTER TABLE rievew_phot
	ADD CONSTRAINT FK_review_TO_rievew_phot -- 후기 -> 후기_사진
		FOREIGN KEY (
			review_no -- 리뷰 번호
		)
		REFERENCES review ( -- 후기
			review_no -- 리뷰 번호
		);